<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name = "viewport" content = "user-scalable=no width=device-width initial-scale=1.0">
    <!-- <meta name = "viewport" content = "initial-scale=1.0, minimum-scale=1.1, maximum-scale=1.0, user-scalable=no"> -->
    <script src="hterm_all.js"></script>
    <style>
      html, body { background:black; margin: 0px; padding: 0px; border: 0px; font-size: 0px}
    </style>
  <body>
    <div id="terminal" style="position:absolute; width:100%; height:100%; overflow:auto;"></div>
    <script>
      hterm.defaultStorage = new lib.Storage.Memory();
      var t = new hterm.Terminal('blink');
      t.prefs_.set('cursor-color', 'rgba(63, 222, 233, 0.5)');
      t.prefs_.set('font-size', 14);
      t.prefs_.set('font-family', "Menlo");

      t.decorate(document.querySelector('#terminal'));

t.onTerminalReady = function() {
  window.webkit.messageHandlers.interOp.postMessage({"op": "terminalready", "data": {}});
      var io = t.io.push();
      t.io.onTerminalResize = function(columns, rows) {
      window.webkit.messageHandlers.interOp.postMessage({"op": "sigwinch", "data": {columns: columns, rows: rows}});
      }
      t.setCursorVisible(true);
      t.prefs_.set('audible-bell-sound', '')
      t.keyboard.uninstallKeyboard();
      }
    var write_to_term = function(data) {
      t.io.print(data);
    }
    var sigwinch = function() {
      var screen = document.getElementsByTagName("iframe")[0].contentWindow.document.getElementsByTagName("x-screen")[0];
      var view_w = window.innerWidth;
      var view_h = window.innerHeight;
      screen.style.width = view_w;
      screen.style.height = view_h;
      
    }
    window.addEventListener('resize', sigwinch);
    var increaseTermFontSize = function() {
      var size = t.getFontSize();
      t.setFontSize(++size);
    }
    var decreaseTermFontSize = function() {
      var size = t.getFontSize();
      t.setFontSize(--size);
    }
    var resetTermFontSize = function() {
      t.setFontSize(0);
    }
    
    var scaleTermStart = function() {
      this.fontSize = t.getFontSize();
    }
    var scaleTerm = function(scale) {
      if (scale > 2.0) scale = 2.0;
      if (scale < 0.5) scale = 0.5;
      t.setFontSize(this.fontSize * scale);
    }
    
    </script>
  </body>
</html>
